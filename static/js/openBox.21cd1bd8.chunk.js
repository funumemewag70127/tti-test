(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{100:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(23);var a=Object(r.b)(function(e,t){var n=e.gameUIStore,r=t.name;return{isActive:n.visiblePopup===r}})(function(e){var t=e.isActive,n=e.children;return t?n():null})},101:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"c",function(){return s});var r,a=n(0),o=n.n(a);!function(e){e.width="width",e.height="height"}(r||(r={}));var i={perfectHeight:0,perfectWidth:0,preferMaxWidth:0,preferMaxHeight:0,winWidth:0,winHeight:0,widthHeightRatio:1,adjustedWidth:0,adjustedHeight:0,finalRatio:1,preferMode:r.width},c=o.a.createContext(i),u=function(){return{winHeight:window.innerHeight,winWidth:window.innerWidth}},s=function(e){var t=e.perfectHeight,n=void 0===t?0:t,a=e.perfectWidth,o=void 0===a?0:a,i=e.preferMaxHeight,c=e.preferMaxWidth,u=e.winWidth,s=void 0===u?0:u,l=(e.winHeight,e.preferMode),p=void 0===l?r.width:l,m=o/n,d=i||n,f=c||o,b=o,h=n,v=o/s,y=1;return p===r.width&&(h=n*(v=(b=f<s?f:s)/o),d=n*v,y=v),{adjustedWidth:b,adjustedHeight:h,widthHeightRatio:m,preferMaxWidth:f,preferMaxHeight:d,finalRatio:y,preferMode:p}}},102:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(0),a=n.n(r);function o(e){var t=e.tHead,n=e.children,r=e.className,o=void 0===r?"":r,i=e.bodyClassName,c=void 0===i?"":i,u=e.style;return a.a.createElement("table",{className:o,style:u},a.a.createElement("thead",null,t),a.a.createElement("tbody",{className:c},n))}},139:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"d",function(){return a}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return i});var r=1e3,a=1500,o=650,i={closed:"closed",opened:"opened",opening:"opening"}},140:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e.top="top",e.bottom="bottom",e.left="left",e.right="right"}(r||(r={}))},141:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return m});var r=n(32),a=n(0),o=n.n(a),i=n(15),c=n.n(i),u=n(142),s=n(50),l=n(17),p=n(140);var m=Object(l.a)(e)(function(e){var t=e.imageIndex,n=e.isActive,i=void 0!==n&&n,l=e.score,m=e.pos,d=Object(a.useState)(!1),f=Object(r.a)(d,2),b=f[0],h=f[1];Object(a.useEffect)(function(){h(!0)},[]);var v=Object(s.a)({width:100,height:100}),y=Object(s.a)({width:55,height:63,fontSize:24,top:-70,left:24,paddingTop:16}),O=function(e){switch(e){case p.a.top:return Object(s.a)({top:300,left:340});case p.a.right:return Object(s.a)({top:660,left:620});case p.a.bottom:return Object(s.a)({top:1020,left:340});case p.a.left:return Object(s.a)({top:660,left:60})}return{}}(m),g=null!==l?o.a.createElement("span",{className:"userScore",style:y},l):null,j=u.b.div({enter:O,active:function(e,t){var n=c.a.clone(t);switch(m){case p.a.top:n.top+=50;break;case p.a.right:n.left-=50;break;case p.a.bottom:n.top-=50;break;case p.a.left:n.left+=50}return n}(0,O),inActive:O}),E="playerInfo userImage userImage".concat(t," ").concat(m," ").concat(i?"active":"");return o.a.createElement(u.a,null,b&&o.a.createElement(j,{key:"player",pose:i?"active":"inActive",className:E,style:v},g))})}).call(this,n(18)(e))},25:function(e,t,n){"use strict";var r=n(1),a=n.n(r),o=n(2),i=n(15),c=n.n(i),u=n(30),s={back:"back",push:"push"},l=new u.b;n.d(t,"b",function(){return f}),n.d(t,"a",function(){return h});var p=[],m="|";function d(e){var t=document.location.hash;document.location.hash="".concat(t).concat(t?m:"").concat(e)}function f(e,t){return b.apply(this,arguments)}function b(){return(b=Object(o.a)(a.a.mark(function e(t,n){var r,o,i=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:{},d(o=n.key),p.push({navigator:t,router:n,options:r,routerName:o}),e.next=6,t.pushPage(n,r);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(){window.history.back()}window.addEventListener("hashchange",function(e){var t=e.newURL,n=e.oldURL;if(t.length<n.length){var r=n.replace(t,"").replace("#","");!function(e){l.emit(s.back,e)}(r),function(e){var t=c.a.last(p),n=t.navigator,r=t.routerName;p.pop(),r===e&&n.popPage()}(r)}}),window.location.hash&&window.history.replaceState(null,"","#")},30:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n(31),a=n(41),o=n(19),i=n(38),c=n(42),u=n(24),s=n(27),l=n(36),p=function(){function e(){Object(u.a)(this,e),this.collection=[]}return Object(s.a)(e,[{key:"push",value:function(){var e;return(e=this.collection).push.apply(e,arguments),this}},{key:"removeAll",value:function(){this.collection.forEach(function(e){return e()}),this.collection=[]}},{key:"getCollection",value:function(){return this.collection}}]),e}(),m=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(a.a)(this,Object(o.a)(t).call(this))).EventKeys={},n.removeEventListeners=[],n.EventKeys=Object(r.a)({},e),n.setMaxListeners(9999),n}return Object(c.a)(t,e),Object(s.a)(t,[{key:"on",value:function(e,n){var r=this;Object(i.a)(Object(o.a)(t.prototype),"on",this).call(this,e,n);var a=function t(){r.removeListener(e,n),r.removeEventListeners=r.removeEventListeners.filter(function(e){return e!==t})};return a.eventName=e,this.removeEventListeners||(this.removeEventListeners=[]),this.removeEventListeners.push(a),a}},{key:"one",value:function(e,t){var n=this.on(e,function(){t.apply(void 0,arguments),n()});return n}},{key:"removeByName",value:function(e){this.removeEventListeners.forEach(function(t){t.eventName===e&&t()}),this.removeEventListeners=this.removeEventListeners.filter(function(t){return t.eventName!==e})}},{key:"removeAll",value:function(){this.removeEventListeners.forEach(function(e){return e()}),this.removeEventListeners=[]}},{key:"createCollection",value:function(){return new p}},{key:"listenToMany",value:function(){var e,t=this.createCollection();return(e=t.getCollection()).push.apply(e,arguments),function(){return t.removeAll()}}}]),t}(l.EventEmitter);t.b=m},324:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"OpenBoxGame",function(){return X});var r=n(1),a=n.n(r),o=n(2),i=n(31),c=n(0),u=n.n(c),s=n(21),l=n(15),p=n.n(l),m=n(23),d=n(358),f=n(144),b=n(69),h=n(25),v=n(63),y=n(325),O=(n(326),n(17)),g=n(35),j=n(327),E=n(356),x=(n(332),n(333)),w=n(357),P=n(334),N=n(355),k=n(336),S=n(337),B=n(338),I=n(339);window.OpenBoxStores=Object(i.a)({},E,f);var A=E.gamePlayerStore,T=f.gameUIStore,_=f.accountStore,H=function(){T.setVisiblePopup(b.b.history)},R=function(){T.setVisiblePopup(b.b.description)},C=function(e){Object(o.a)(a.a.mark(function t(){var n,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(y.a)();case 2:return n=t.sent,t.next=5,n.loadGame(e);case 5:r=t.sent,T.setVisiblePopup(b.b.none),T.setScene(b.a.gamePlayer),A.startGame(r),A.onGameEnd(function(){return T.setVisiblePopup(b.b.gameResult)});case 10:case"end":return t.stop()}},t)}))()},G=function(){A.quit(),T.setScene(b.a.moneySelector)},D=function(){T.setVisiblePopup(b.b.none),T.setScene(b.a.moneySelector),A.quit()},L=function(e){Object(o.a)(a.a.mark(function t(){var n,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(v.a)();case 2:return n=t.sent,r=n.submitGame,t.prev=4,t.next=7,r(Object(i.a)({},e,{betType:3,issueNo:0,nums:[],amounts:[],betAddress:A.betAddress}));case 7:_.updateDataVersion(),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(4),alert(t.t0);case 13:T.setVisiblePopup(b.b.none);case 14:case"end":return t.stop()}},t,null,[[4,10]])}))()},M=function(e){T.setVisiblePopup(b.b.authForm,{money:e})},W=function(e,t){return p.a.map(e,function(e){return Object(i.a)({},e,{currentUserId:t,id:e.id||p.a.random(0)})})};function X(e){var t=e.dataVersion;Object(c.useEffect)(function(){return Object(o.a)(a.a.mark(function e(){var t,n,r,o,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(y.a)();case 2:return t=e.sent,n=t.getHistoryList,r=t.getBetAddress,e.next=7,n();case 7:return o=e.sent,E.historyStore.setDisplayList(W(o,_.account)),e.next=11,r();case 11:i=e.sent,A.setBetAddress(i);case 13:case"end":return e.stop()}},e)}))(),function(){A.quit()}},[t]);var n=[{name:b.b.history,renderer:function(){return u.a.createElement(B.a,{onPlayGame:C})}},{name:b.b.authForm,renderer:function(){return u.a.createElement(S.a,{onSubmit:L})}},{name:b.b.gameResult,renderer:function(){return u.a.createElement(x.a,{onQuit:D})}},{name:b.b.description,renderer:function(){return u.a.createElement(I.a,null)}}],r=Object(c.useCallback)(function(){return Object(h.a)()},[]);return u.a.createElement(s.Page,{className:"openBoxGamePage"},u.a.createElement(j.a,{perfectHeight:1344,perfectWidth:750,preferMaxWidth:600},u.a.createElement(m.a,Object.assign({},f,E),u.a.createElement(N.a,{onShowHistory:H,onShowDescription:R,onQuitGame:r,onQuitPlayer:G,popups:n},u.a.createElement(d.a,{name:b.a.moneySelector},function(){return u.a.createElement(k.a,{moneyList:Object(P.a)(),onSelect:M})}),u.a.createElement(d.a,{name:b.a.gamePlayer},function(){return u.a.createElement(w.a,null)})))))}t.default=Object(O.a)(e,u.a.memo,g.a)(X)}.call(this,n(18)(e))},325:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(1),a=n.n(r),o=n(2),i=n(55);function c(){return u.apply(this,arguments)}function u(){return(u=Object(o.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(i.a)()){e.next=2;break}return e.abrupt("return",n.e(26).then(n.bind(null,353)).then(function(e){return e.default}));case 2:return e.abrupt("return",Promise.all([n.e(0),n.e(1),n.e(21)]).then(n.bind(null,354)).then(function(e){return e.default}));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}},326:function(e,t,n){},327:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(31),a=n(32),o=n(0),i=n.n(o),c=n(15),u=n.n(c),s=n(101),l=i.a.memo(function(e){var t=e.preferMode,n=void 0===t?s.a.width:t,c=e.perfectHeight,l=e.perfectWidth,p=(e.preferMaxHeight,e.preferMaxWidth),m=void 0===p?900:p,d=e.children,f=Object(o.useState)(Object(s.d)()),b=Object(a.a)(f,2),h=b[0],v=h.winHeight,y=h.winWidth,O=b[1];Object(o.useEffect)(function(){window.addEventListener("resize",function(){O(Object(s.d)())})},[]);var g=s.b.Provider,j={winHeight:v,winWidth:y,perfectHeight:c,perfectWidth:l,preferMaxWidth:m},E=Object(s.c)(Object(r.a)({},j,{preferMode:n})),x=u.a.extend({},j,E);return i.a.createElement(g,{value:x},d)})},329:function(e,t,n){e.exports=n.p+"static/media/oh_no.4b9dfc8c.mp3"},330:function(e,t,n){e.exports=n.p+"static/media/add-score.e14110a0.mp3"},331:function(e,t,n){e.exports=n.p+"static/media/result.e786a7c7.wav"},332:function(e,t,n){},333:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(0),a=n.n(r),o=n(23),i=n(81),c=n(102),u=n(80),s=n(141),l=function(e){return e&&e.toNumber?e.toNumber():e};var p=Object(o.b)(function(e){var t=e.gamePlayerStore,n=e.web3;return{gameRecord:t?t.gameRecord:null,web3:n}})(function(e){var t=e.onQuit,n=e.gameRecord,r=e.web3;if(!r)return null;var o=n?Object(u.c)(n).sort(function(e,t){return e.score&&t.score&&e.score.comparedTo&&t.score.comparedTo?t.score.comparedTo(e.score):e-t}):[],p=a.a.createElement("tr",null,a.a.createElement("th",{className:"rankIcon"}," "),a.a.createElement("th",{className:"playerIcon"}," "),a.a.createElement("th",{className:"playerName"},"\u73a9\u5bb6"),a.a.createElement("th",{className:"payerScore"},"\u94bb\u77f3"),a.a.createElement("th",{className:"payerAward"},"\u5956\u52b1"));return a.a.createElement(i.a,{title:"\u6392\u884c",onQuit:t,className:"gameResultPopup"},a.a.createElement(c.a,{tHead:p,className:"gameResult"},o.map(function(e,t){return a.a.createElement("tr",{key:e.id},a.a.createElement("td",{className:"rankIcon"},a.a.createElement("div",{className:"rankImage rankImage".concat(t+1)},t)),a.a.createElement("td",{className:"playerIcon"},a.a.createElement(s.a,{id:e.id,imageIndex:e.imageIndex})),a.a.createElement("td",{className:"playerName"},e.id.slice(-6)),a.a.createElement("td",{className:"payerScore"},l(e.score)),a.a.createElement("td",{className:"payerAward"},r.fromWei(l(e.gain),"ether")))})))})},334:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(14),a=function(){return[{money:10,text:Object(r.a)().OPEN_BOX_PAGE.OPEN_BOX_MONEY_TEXT_1},{money:2e3,text:Object(r.a)().OPEN_BOX_PAGE.OPEN_BOX_MONEY_TEXT_2},{money:5e3,text:Object(r.a)().OPEN_BOX_PAGE.OPEN_BOX_MONEY_TEXT_3},{money:1e4,text:Object(r.a)().OPEN_BOX_PAGE.OPEN_BOX_MONEY_TEXT_4},{money:5e4,text:Object(r.a)().OPEN_BOX_PAGE.OPEN_BOX_MONEY_TEXT_5}]}},335:function(e,t,n){e.exports=n.p+"static/media/beijingtu.03f0d956.png"},336:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),a=n.n(r),o=n(50);var i=a.a.memo(function(e){var t=e.moneyList,n=e.onSelect,r=Object(o.a)({width:180,height:90,fontSize:24});return a.a.createElement("div",{className:"moneySelector"},t.map(function(e){var t=e.money,o=e.text;return a.a.createElement("div",{key:t},a.a.createElement("button",{type:"button",className:"moneySelectorButton moneySelectorButton_".concat(t),style:r,onClick:function(){return n(t)}},o))}))})},337:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),a=n.n(r),o=n(23),i=n(81),c=n(14);var u=Object(o.b)(function(e){var t=e.accountStore,n=e.gameUIStore;if(!t||!n)return{};var r=n.popupData.money;return{account:t.account,ttBalance:t.ttBalance,tokenBalance:t.tokenBalance,gas:t.gas,money:r}})(function(e){var t=e.onSubmit,n=e.account,o=e.ttBalance,u=e.tokenBalance,s=e.money,l=void 0===s?0:s,p=Object(r.useCallback)(function(){t({account:n,money:l})},[]);return a.a.createElement(i.a,{title:Object(c.a)().CONFIRM_SUBMIT,className:"gameAuthFormPopup"},a.a.createElement("div",{className:"gameAuthForm"},a.a.createElement("div",{className:"gameAuthFormField"},Object(c.a)().ACCOUNT,"\xa0:\xa0",n),a.a.createElement("div",{className:"gameAuthFormField"},Object(c.a)().TT_BALANCE,"\xa0:\xa0",o),a.a.createElement("div",{className:"gameAuthFormField"},Object(c.a)().TOKEN_BALANCE,"\xa0:\xa0",u),a.a.createElement("hr",null),a.a.createElement("div",{className:"gameAuthFormField",style:{marginTop:"20px"}},a.a.createElement("button",{type:"submit",onClick:p},Object(c.a)().SUBMIT))))})},338:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return m});var r=n(0),a=n.n(r),o=n(23),i=n(99),c=n.n(i),u=n(14),s=n(81),l=n(102),p=n(17);var m=Object(p.a)(e,Object(o.b)(function(e){var t=e.historyStore;return{displayList:t?t.displayList:[]}}))(function(e){var t=e.onPlayGame,n=e.displayList,r=a.a.createElement("tr",null,a.a.createElement("th",{className:"historyNo"},Object(u.a)().OPEN_BOX_PAGE.HISTORY_NO),a.a.createElement("th",null,Object(u.a)().AMOUNT),a.a.createElement("th",{className:"historyDate"},Object(u.a)().OPEN_BOX_PAGE.HISTORY_DATE),a.a.createElement("th",{className:"historyAction"}," ")),o=a.a.useCallback(function(e){return a.a.createElement("tr",{key:e.id},a.a.createElement("td",{className:"historyNo"},e.issueNo),a.a.createElement("td",null,e.money),a.a.createElement("td",{className:"historyDate"},c()(e.time).format("MM/DD HH:mm")),a.a.createElement("td",{className:"historyAction"},a.a.createElement("button",{className:"historyActionButton",onClick:function(){return t(e)},type:"button"})))},[]),i=n?n.map(o):null;return a.a.createElement(s.a,{title:Object(u.a)().OPEN_BOX_PAGE.HISTORY},a.a.createElement(l.a,{tHead:r,className:"historyList",bodyClassName:"purchaseListTbody"},i))})}).call(this,n(18)(e))},339:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var r=n(1),a=n.n(r),o=n(2),i=n(32),c=n(0),u=n.n(c),s=n(23),l=n(81),p=n(14);var m=Object(s.b)(function(e){var t=e.gamePlayerStore,n=e.web3;return{gameRecord:t?t.gameRecord:null,web3:n}})(function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(c.useEffect)(function(){Object(o.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(Object(p.a)().HTML_FILES.GAME_DESCRIPTION);case 2:return t=e.sent,e.t0=r,e.next=6,t.text();case 6:e.t1=e.sent,(0,e.t0)(e.t1);case 8:case"end":return e.stop()}},e)}))()},[]),u.a.createElement(l.a,{title:Object(p.a)().OPEN_BOX_PAGE.DESCRIPTION,className:"gameDescriptionPopup"},u.a.createElement("div",{dangerouslySetInnerHTML:{__html:n}}))})},35:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(23),a=n(17);function o(e){return Object(r.b)(function(e){var t=e.accountStore;return{locale:t.locale,dataVersion:t.dataVersion,updateDataVersion:function(){return t.updateDataVersion()}}})(e)}function i(e){return Object(a.a)(r.c,o)(e)}},355:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(110),i=n(32),c=n(100),u=a.a.createContext({});function s(e){var t=e.popups,n=function(e){var t=Object(r.useState)(e),n=Object(i.a)(t,2),a=n[0],c=n[1];return{popups:a,showPopup:function(e){c([].concat(Object(o.a)(a),[e]))},closePopup:function(e){c(a.filter(function(t){return t.name!==e}))}}}(void 0===t?[]:t),s=n.showPopup,l=n.popups;return a.a.createElement(u.Provider,{value:{showPopup:s}},a.a.createElement(r.Fragment,null,l.map(function(e){var t=e.name,n=e.renderer;return a.a.createElement(c.a,{key:t,name:t},n)})))}var l=n(101),p=n(335),m=n.n(p),d=n(50),f=n(23),b=n(14),h=n(69);function v(e){var t=e.onQuitPlayer,n=e.onQuitGame,r=e.isPlayerActive?t:n;if(!r)return null;var o=Object(d.a)({paddingTop:16,fontSize:28,width:280,height:120});return a.a.createElement("button",{className:"gameQuitButton",onClick:r,type:"button",style:o},Object(b.a)().BACK)}v.defaultProps={isPlayerActive:!1};var y=Object(f.b)(function(e){var t=e.gameUIStore;return{isPlayerActive:t&&t.scene===h.a.gamePlayer}})(v);function O(e){var t=e.onShowHistory,n=Object(d.a)({paddingTop:16,fontSize:28,width:280,height:120});return a.a.createElement("button",{className:"gameHistoryButton",onClick:t,type:"button",style:n},Object(b.a)().OPEN_BOX_PAGE.HISTORY)}a.a.memo(O);var g=n(17);var j=Object(g.a)(a.a.memo,Object(f.b)(function(e){var t=e.gameUIStore;return{isPlayerActive:t&&t.scene===h.a.gamePlayer}}))(function(e){var t=e.onShowDescription,n=e.isPlayerActive;if(void 0!==n&&n)return null;var r=Object(d.a)({position:"absolute",fontSize:26,width:280,height:120,top:300,left:150});return a.a.createElement("div",{className:"gameDescriptionButton",onClick:t,style:r},Object(b.a)().OPEN_BOX_PAGE.DESCRIPTION)});function E(e){var t=e.children,n=e.onShowHistory,o=e.popups,i=void 0===o?[]:o,c=e.onQuitGame,u=e.onQuitPlayer,p=e.onShowDescription,f=Object(r.useContext)(l.b),b=f.adjustedHeight,h={width:f.adjustedWidth,height:b},v=Object(d.a)({paddingTop:460});return a.a.createElement("div",{className:"gameApplication",style:h},a.a.createElement("img",{src:m.a,alt:"background",className:"backgroundImage"}),a.a.createElement(O,{onShowHistory:n}),a.a.createElement(j,{onShowDescription:p}),a.a.createElement(y,{onQuitGame:c,onQuitPlayer:u}),a.a.createElement("div",{className:"gameDesktop"},a.a.createElement("div",{className:"gameDesktopContent",style:v},t)),a.a.createElement(s,{popups:i}))}n.d(t,"a",function(){return E})},356:function(e,t,n){"use strict";n.r(t);var r,a,o,i,c,u,s,l,p,m,d,f,b,h,v=n(66),y=n(24),O=n(27),g=n(67),j=(n(68),n(51)),E=new(r=function(){function e(){Object(y.a)(this,e),Object(v.a)(this,"displayList",a,this)}return Object(O.a)(e,[{key:"setDisplayList",value:function(e){this.displayList=e}}]),e}(),a=Object(g.a)(r.prototype,"displayList",[j.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(g.a)(r.prototype,"setDisplayList",[j.b],Object.getOwnPropertyDescriptor(r.prototype,"setDisplayList"),r.prototype),r),x=n(41),w=n(19),P=n(85),N=n(42),k=n(15),S=n(30),B=n(139),I=n(80),A="ON_GAME_NOT_READY",T=new(function(e){function t(){var e,n;Object(y.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(x.a)(this,(e=Object(w.a)(t)).call.apply(e,[this].concat(a)))).onGameReadyStatusChange=function(e){return n.on(A,e)},n.triggerGameReadyStatus=function(e){return n.emit(A,e)},n}return Object(N.a)(t,e),t}(S.a))({}),_=new(o=function(e){function t(){var e,n;Object(y.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(x.a)(this,(e=Object(w.a)(t)).call.apply(e,[this].concat(a)))).EventKeys={start:"start",end:"end",pause:"pause",resume:"resume",beginOpenBox:"beginOpenBox",finishOpenBox:"finishOpenBox"},Object(v.a)(n,"betAddress",i,Object(P.a)(n)),Object(v.a)(n,"gameRecord",c,Object(P.a)(n)),Object(v.a)(n,"openIndex",u,Object(P.a)(n)),Object(v.a)(n,"finishedOpenIndex",s,Object(P.a)(n)),Object(v.a)(n,"openingBox",l,Object(P.a)(n)),Object(v.a)(n,"isPaused",p,Object(P.a)(n)),n.playerTimeout=0,Object(v.a)(n,"playerScores",m,Object(P.a)(n)),Object(v.a)(n,"boomedHeroId",d,Object(P.a)(n)),Object(v.a)(n,"fasterTimes",f,Object(P.a)(n)),Object(v.a)(n,"pause",b,Object(P.a)(n)),Object(v.a)(n,"resume",h,Object(P.a)(n)),n}return Object(N.a)(t,e),Object(O.a)(t,[{key:"setBetAddress",value:function(e){this.betAddress=e}},{key:"startGame",value:function(e){var t=this;return this.resetPlayer(),e?(!1===e.play?(this.isPaused=!0,T.triggerGameReadyStatus(!1)):T.triggerGameReadyStatus(!0),this.gameRecord=e,this.emit(this.EventKeys.start),Promise.resolve(this.playBoxByIndex(0)).then(function(e){e&&!t.isPaused&&(t.emit(t.EventKeys.end),Object(I.d)(I.a.result))})):Promise.resolve()}},{key:"restartGame",value:function(){this.gameRecord&&this.startGame(this.gameRecord)}},{key:"clearPlayerTimeout",value:function(){this.playerTimeout&&(clearTimeout(this.playerTimeout),this.playerTimeout=0)}},{key:"playBoxByIndex",value:function(e){var t=this;if(!this.gameRecord)return!1;this.openIndex=e,this.openingBox=null;var n=Object(I.b)(this.gameRecord);return e<n.length&&e>=0?this.waitTimeout(Object(j.b)("onPrepareBox",function(){var r,a=(r=e,k.find(n,function(e){return e.openIndex===r}));return t.openingBox=a,t.emit(t.EventKeys.beginOpenBox,e,a),t.waitTimeout(Object(j.b)("onBoxOpen",function(){if(t.isPaused)return!1;if(t.finishedOpenIndex=e,t.emit(t.EventKeys.finishOpenBox,e,a),a){var n=a.heroPos;if(0===a.score)t.playerScores[n]=0,t.boomedHeroId=a.heroId,Object(I.d)(I.a.boom);else{Object(I.d)(I.a.addScore);var r=t.playerScores[n];t.playerScores[n]=r+a.score,t.boomedHeroId=null}}return t.waitTimeout(function(){return t.playBoxByIndex(e+1)},B.c)}),B.b)}),B.d):(this.openIndex=-1,this.openingBox=null,!0)}},{key:"clearBoomer",value:function(){this.boomedHeroId=null}},{key:"waitTimeout",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B.c;return new Promise(function(r){t.playerTimeout=setTimeout(function(){return r(e())},n*t.fasterTimes)})}},{key:"toggleFaster",value:function(){1===this.fasterTimes?this.fasterTimes=.2:this.fasterTimes=1}},{key:"resetPlayer",value:function(){this.fasterTimes=1,this.gameRecord=null,this.openingBox=null,this.openIndex=-1,this.finishedOpenIndex=-1,this.isPaused=!1,this.boomedHeroId=null,this.playerScores={top:0,right:0,bottom:0,left:0},this.clearPlayerTimeout()}},{key:"quit",value:function(){this.resetPlayer(),this.removeAll()}},{key:"onBeginOpenBox",value:function(e){return this.on(this.EventKeys.beginOpenBox,e)}},{key:"onFinishOpenBox",value:function(e){return this.on(this.EventKeys.finishOpenBox,e)}},{key:"onStart",value:function(e){return this.on(this.EventKeys.start,e)}},{key:"onGameEnd",value:function(e){return this.on(this.EventKeys.end,e)}},{key:"onPause",value:function(e){return this.on(this.EventKeys.pause,e)}},{key:"onResume",value:function(e){return this.on(this.EventKeys.resume,e)}}]),t}(S.a),i=Object(g.a)(o.prototype,"betAddress",[j.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(g.a)(o.prototype,"setBetAddress",[j.b],Object.getOwnPropertyDescriptor(o.prototype,"setBetAddress"),o.prototype),c=Object(g.a)(o.prototype,"gameRecord",[j.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),u=Object(g.a)(o.prototype,"openIndex",[j.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),s=Object(g.a)(o.prototype,"finishedOpenIndex",[j.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),l=Object(g.a)(o.prototype,"openingBox",[j.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p=Object(g.a)(o.prototype,"isPaused",[j.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m=Object(g.a)(o.prototype,"playerScores",[j.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{top:0,right:0,bottom:0,left:0}}}),d=Object(g.a)(o.prototype,"boomedHeroId",[j.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=Object(g.a)(o.prototype,"fasterTimes",[j.k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Object(g.a)(o.prototype,"startGame",[j.b],Object.getOwnPropertyDescriptor(o.prototype,"startGame"),o.prototype),Object(g.a)(o.prototype,"restartGame",[j.b],Object.getOwnPropertyDescriptor(o.prototype,"restartGame"),o.prototype),Object(g.a)(o.prototype,"clearPlayerTimeout",[j.b],Object.getOwnPropertyDescriptor(o.prototype,"clearPlayerTimeout"),o.prototype),Object(g.a)(o.prototype,"playBoxByIndex",[j.b],Object.getOwnPropertyDescriptor(o.prototype,"playBoxByIndex"),o.prototype),Object(g.a)(o.prototype,"clearBoomer",[j.b],Object.getOwnPropertyDescriptor(o.prototype,"clearBoomer"),o.prototype),Object(g.a)(o.prototype,"toggleFaster",[j.b],Object.getOwnPropertyDescriptor(o.prototype,"toggleFaster"),o.prototype),b=Object(g.a)(o.prototype,"pause",[j.b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isPaused=!0,e.clearPlayerTimeout()}}}),h=Object(g.a)(o.prototype,"resume",[j.b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isPaused=!1,e.playBoxByIndex(e.openIndex)}}}),Object(g.a)(o.prototype,"resetPlayer",[j.b],Object.getOwnPropertyDescriptor(o.prototype,"resetPlayer"),o.prototype),Object(g.a)(o.prototype,"quit",[j.b],Object.getOwnPropertyDescriptor(o.prototype,"quit"),o.prototype),o);n.d(t,"historyStore",function(){return E}),n.d(t,"gamePlayerStore",function(){return _})},357:function(e,t,n){"use strict";var r,a,o,i=n(0),c=n.n(i),u=n(23),s=n(80),l=n(141),p=n(15),m=n.n(p),d=n(102),f=n(14),b=n(50),h=n(24),v=n(27),y=n(41),O=n(19),g=n(42),j=n(34),E=n(139),x=Object(j.a)({},E.a.opening,"animated swing active"),w=Object(u.b)(function(e){return{gamePlayerStore:e.gamePlayerStore}})(r=Object(u.c)((o=a=function(e){function t(){var e,n;Object(h.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(y.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(a)))).isBoxOpened=function(){var e=n.props,t=e.openIndex,r=e.gamePlayerStore;return!!r&&t<=r.finishedOpenIndex},n}return Object(g.a)(t,e),Object(v.a)(t,[{key:"getStatus",value:function(){var e=this.props,t=e.boxIndex,n=e.gamePlayerStore,r=this.isBoxOpened(),a=n&&n.openingBox&&n.openingBox.boxIndex===t;return r?E.a.opened:a?E.a.opening:E.a.closed}},{key:"getAnimatedClassByStatus",value:function(e){var t=this.props.gamePlayerStore;return!t||t.isPaused?"":x[e]||""}},{key:"render",value:function(){var e=this.props,t=e.score,n=e.boxCover,r=0===t,a=this.getStatus(),o=r?"boom":"",i=t>=5?"largerThen5":"lessThen5",u="box".concat(n),s="".concat(o," ").concat(i," score score").concat(t),l="".concat(u),p=Object(b.a)({width:100,height:132});return c.a.createElement("div",{className:"box box-".concat(a," ").concat(l," ").concat(this.getAnimatedClassByStatus(a)," xk"),style:p},this.isBoxOpened()?c.a.createElement("div",{className:s},r?null:" "):null)}}]),t}(c.a.Component),a.defaultProps={boxCover:0},r=o))||r)||r,P=4,N=function(){return m.a.range(4)};var k=Object(u.b)(function(e){var t=e.gamePlayerStore;return{gameRecord:t&&t.gameRecord}})(function(e){var t=e.gameRecord;Object(i.useEffect)(function(){t&&!t.play&&setTimeout(function(){return alert(Object(f.a)().GAME_IS_NOT_READY)},300)},[t&&t.id]);var n=Object(b.a)({width:320});return c.a.createElement(d.a,{className:"boxGrid",style:n},N().map(function(e){return c.a.createElement("tr",{key:e},N().map(function(n){return function(e,n){var r=e*P+n,a=t?Object(s.b)(t)[r]:null;return a?c.a.createElement("td",{key:n},c.a.createElement(w,{boxIndex:r,openIndex:a.openIndex,score:a.score,boxCover:m.a.random(1,3)})):c.a.createElement("td",{key:n})}(e,n)}))}))});n.d(t,"a",function(){return S});var S=Object(u.b)(function(e){var t=e.gamePlayerStore;return{gameRecord:t?t.gameRecord:null,playerScores:t?t.playerScores:{},openIndex:t?t.openIndex:-1}})(Object(u.c)(function(e){var t=e.gameRecord,n=e.playerScores,r=e.openIndex,a=void 0===r?-1:r,o=t?Object(s.c)(t):[];return c.a.createElement(c.a.Fragment,null,o.map(function(e){return c.a.createElement(l.a,{key:e.id,imageIndex:e.imageIndex,score:(r=e.pos,t&&n?n[r]:0),pos:e.pos,isActive:a%4===e.index});var r}),c.a.createElement(k,null))}))},358:function(e,t,n){"use strict";var r=n(23);var a=Object(r.b)(function(e,t){var n=e.gameUIStore,r=t.name;return{isActive:n.scene===r}})(function(e){var t=e.isActive,n=e.children;return t?n():null});n(100);n.d(t,"a",function(){return a})},50:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),a=n(15),o=n.n(a),i=n(101);function c(e){var t=Object(r.useContext)(i.b).finalRatio;return o.a.reduce(e,function(e,n,r){var a;return n&&o.a.isNumber(n)&&(e[r]=(a=n)?a*t:0),e},e)}},80:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return l});var r=n(15),a=n.n(r),o=n(328),i=n(140),c={boom:n(329),addScore:n(330),result:n(331)};function u(e){new o.Howl({src:[e]}).play()}function s(e){var t=e.currentUserId,n=e.playerAddrs,r=e.playerScores,o=e.playerAwards,c=void 0===o?[]:o,u=n.indexOf(t),s=function(e){var t=function(){return a.a.random(1,12)};return a.a.reduce(e,function(e,n){var r=e,a=p[n],o=Object.values(r);return(void 0===a||o.indexOf(a)>=0)&&(a=function(e){var n;do{n=t()}while(e.indexOf(n)>=0);return n}(o)),r[n]=a,p[n]=a,r},{})}(n),l=[],m=u-2;m>0?function(){for(var e=m;e<n.length;e++)l.push(n[e]);for(var t=0;t<m;t++)l.push(n[t])}():m<0?function(){for(var e=n.length+m,t=e;t<n.length;t++)l.push(n[t]);for(var r=0;r<e;r++)l.push(n[r])}():l=a.a.cloneDeep(n);var d=function(e,t){var a=l[t],o=n.indexOf(a);return{id:a,pos:e,index:o,isCurrentUser:!1,score:r[o],gain:c[o],imageIndex:s[a]}};return[d(i.a.top,0),d(i.a.right,1),function(e){var t=n.indexOf(e);return{id:e,pos:i.a.bottom,index:t,isCurrentUser:!0,score:r[t],imageIndex:s[e],gain:c[t]}}(t),d(i.a.left,3)]}function l(e){var t=e.scores,n=e.sequencs,r=e.playerAddrs,o=s(e);return t.map(function(e,t){var i=n.indexOf(t);-1===i&&(i=t);var c=r[i%4],u=a.a.find(o,function(e){return e.id===c});return{boxIndex:t,score:e,openIndex:i,heroId:c,heroIndex:u?u.index:-1,heroInfo:u,heroPos:u?u.pos:""}})}var p={}},81:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n(32),a=n(0),o=n.n(a),i=n(15),c=n.n(i),u=n(142),s=n(23),l=n(69),p=u.b.div({enter:{y:0,opacity:1,delay:300,transition:{y:{type:"spring",stiffness:1e3,damping:15},default:{duration:300}}},exit:{y:50,opacity:0,transition:{duration:150}}}),m=u.b.div({enter:{opacity:.8},exit:{opacity:0}});var d=Object(s.b)(function(e,t){var n=e.gameUIStore,r=t.onQuit;return{onQuit:c.a.debounce(function(){r&&r(),n.setVisiblePopup(l.b.none)},50)}})(function(e){var t=e.title,n=e.className,i=void 0===n?"":n,c=e.onQuit,s=e.children,l=Object(a.useState)(!1),d=Object(r.a)(l,2),f=d[0],b=d[1];return Object(a.useEffect)(function(){b(!0)},[]),o.a.createElement("div",{className:"popup ".concat(i)},o.a.createElement(u.a,null,f&&[o.a.createElement(m,{key:"popupBackdrop",className:"popupBackdrop",onClick:c,onTouchEnd:c,onKeyDown:function(){},role:"button",tabIndex:0,"aria-label":"click to close popup"}),o.a.createElement(p,{key:"popupWrapper",className:"popupWrapper"},o.a.createElement("div",{className:"popupContainer"},o.a.createElement("div",{className:"popupHeader"},o.a.createElement("button",{onClick:c,onTouchEnd:c,type:"button",className:"popupQuitButton"},"Quit"),o.a.createElement("h2",null,t)),o.a.createElement("div",{className:"popupBody"},o.a.createElement("div",{className:"popupContent"},s))))]))})}}]);
//# sourceMappingURL=openBox.21cd1bd8.chunk.js.map