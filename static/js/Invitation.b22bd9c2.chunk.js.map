{"version":3,"sources":["common/utils/NavigatorEvents.ts","common/utils/navigatorHelper.ts","common/utils/EventEmitter.ts","home/components/accountTab/InvitationPage.tsx","common/utils/watchAccountChange.ts","common/components/withAPI.tsx","home/components/Header.tsx","apis/home/getHomeAPI.ts"],"names":["EventKeys","back","push","NavigatorEvents","EventEmitter","historyStack","HashSplitter","pushHash","hash","currentHash","document","location","concat","pushPage","_x","_x2","_pushPage","apply","this","arguments","_callee","navigator","router","options","routerName","_args","regenerator_default","a","wrap","_context","prev","next","length","undefined","key","stop","popPage","window","history","addEventListener","event","newURL","oldURL","componentName","replace","emit","emitBack","_ref","_","last","pop","popPageInner","replaceState","Collection","collection","_this$collection","forEach","fn","_EventEmitterBase","eventKeys","_this","Object","D_workspace_web3game_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_5__","D_workspace_web3game_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_1__","D_workspace_web3game_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_2__","call","removeEventListeners","D_workspace_web3game_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","setMaxListeners","D_workspace_web3game_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__","D_workspace_web3game_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_6__","value","eventName","_this2","D_workspace_web3game_node_modules_babel_runtime_helpers_esm_get__WEBPACK_IMPORTED_MODULE_3__","prototype","removeFn","removeListener","filter","o","dispose","on","name","_collection$getCollec","createCollection","getCollection","removeAll","EventEmitterBase","InvitationPagePure","code","myInviter","invitationList","onSetInvitor","renderFixed","createHeaderRender","getLang","HOME_PAGE","INVITATION","_useState","useState","_useState2","D_workspace_web3game_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","invitatorValue","setInvitatorValue","_useState3","_useState4","toastText","setToastText","submitInvitator","react__WEBPACK_IMPORTED_MODULE_3___default","createElement","react_onsenui__WEBPACK_IMPORTED_MODULE_5__","_common_Block__WEBPACK_IMPORTED_MODULE_12__","noMargin","oneHorizontalPadding","transparent","MY_INVITATION_CODE","react_clipboard_js__WEBPACK_IMPORTED_MODULE_8___default","component","data-clipboard-text","onClick","text","COPIED","setTimeout","icon","isOpen","oneMarginBottom","MY_INVITOR","style","fontSize","className","onChange","e","target","width","SET_INVITOR","MY_GROUP","dataSource","renderRow","item","index","paddingLeft","InvitationPage","compose","module","React","memo","watchAccountChange","withAPI","_ref3","D_workspace_web3game_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","D_workspace_web3game_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","mark","_callee2","_ref2","updateDataVersion","homeAPI","_ref4","_context2","getHomeAPI","sent","getInvitationResponse","invitor","trim","alert","INVITE","INVITATION_CODE_INVALID","setInvitor","t0","message","INVITATION_CODE_EMPTY","abrupt","__webpack_require__","d","__webpack_exports__","mobx_react__WEBPACK_IMPORTED_MODULE_0__","_compose__WEBPACK_IMPORTED_MODULE_1__","injectMainAccountData","Component","inject","accountStore","locale","dataVersion","observer","defaultGetAPIDependencies","props","values","apiFetchers","getApiDependencies","apiValues","setApiValues","dependencies","get","useEffect","responseValues","C","assign","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","react_onsenui__WEBPACK_IMPORTED_MODULE_1__","_web3game_lang__WEBPACK_IMPORTED_MODULE_2__","_web3game_common_utils_navigatorHelper__WEBPACK_IMPORTED_MODULE_3__","Header","_ref$backText","backText","BACK","_ref$hasBack","hasBack","_ref$onBack","onBack","_ref$title","title","_ref$renderRightButto","renderRightButton","otherProps","_getHomeAPI","isUsingMockAPI","then","bind","m","default","Promise","all"],"mappings":"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","file":"static/js/Invitation.b22bd9c2.chunk.js","sourcesContent":["import EventEmitter from \"./EventEmitter\";\r\n\r\nconst EventKeys = {\r\n    back: 'back',\r\n    push: 'push',\r\n};\r\n\r\nconst NavigatorEvents = new EventEmitter();\r\n\r\nexport function emitBack(componentName: string) {\r\n    NavigatorEvents.emit(EventKeys.back, componentName);\r\n}\r\n\r\nexport function onBack(fn: (componentName: string) => void) {\r\n    return NavigatorEvents.on(EventKeys.back, fn);\r\n}\r\n\r\nexport function emitPush(componentName: string) {\r\n    NavigatorEvents.emit(EventKeys.push, componentName);\r\n}\r\n\r\nexport function onPush(fn: (componentName: string) => void) {\r\n    return NavigatorEvents.on(EventKeys.push, fn);\r\n}\r\n\r\n","import _ from 'lodash';\r\nimport {Navigator, PageTransitionOptions} from \"react-onsenui\";\r\nimport {emitBack} from \"./NavigatorEvents\";\r\n\r\n\r\nconst historyStack: object[] = [];\r\n\r\nexport const hasHistory = () => historyStack.length > 0;\r\n\r\nconst HashSplitter = '|';\r\n\r\nfunction pushHash(hash: string) {\r\n    const currentHash = document.location.hash;\r\n    document.location.hash = `${currentHash}${currentHash ? HashSplitter : ''}${hash}`;\r\n}\r\n\r\nexport async function pushPage(\r\n    navigator: Navigator,\r\n    router: any,\r\n    options: PageTransitionOptions = {\r\n    },\r\n) {\r\n    const routerName = router.key;\r\n    pushHash(routerName);\r\n    historyStack.push({ navigator, router, options, routerName });\r\n    await navigator.pushPage(router, options);\r\n}\r\n\r\nexport function popPage() {\r\n    window.history.back();\r\n}\r\n\r\nfunction popPageInner(componentName: string) {\r\n    const { navigator, routerName } = _.last(historyStack) as any;\r\n\r\n    historyStack.pop();\r\n\r\n    if (routerName === componentName) {\r\n        navigator.popPage();\r\n    }\r\n}\r\n\r\n// handle history back\r\nwindow.addEventListener('hashchange', (event) => {\r\n    const { newURL, oldURL } = event;\r\n    if (newURL.length < oldURL.length) {\r\n        const componentName = oldURL.replace(newURL, '').replace('#', '');\r\n        emitBack(componentName);\r\n        popPageInner(componentName);\r\n    }\r\n});\r\n\r\nif (window.location.hash) {\r\n    window.history.replaceState(null, '', '#');\r\n}\r\n\r\n\r\n","/**\r\n * Created by trump on 16/6/18.\r\n */\r\nimport {EventEmitter as EventEmitterBase} from \"events\";\r\n\r\n\r\nclass Collection {\r\n    private collection: (() => void)[] = [];\r\n\r\n    /** @returns {Collection} */\r\n    public push(...fn: (() => void)[]) {\r\n        this.collection.push(...fn);\r\n        return this;\r\n    }\r\n\r\n    public removeAll() {\r\n        this.collection.forEach(fn => fn());\r\n        this.collection = [];\r\n    }\r\n\r\n    public getCollection() {\r\n        return this.collection;\r\n    }\r\n}\r\n\r\nexport class EventEmitter extends EventEmitterBase {\r\n\r\n    protected EventKeys = {};\r\n\r\n    private removeEventListeners: (() => void)[] = [];\r\n\r\n    public constructor(eventKeys?: object) {\r\n        super();\r\n\r\n        /** @field */\r\n        this.EventKeys = { ...eventKeys };\r\n\r\n        this.setMaxListeners(9999);\r\n    }\r\n\r\n    // @ts-ignore\r\n    public on(eventName: string, fn: (() => void) | any) {\r\n        super.on(eventName, fn);\r\n\r\n        const removeFn = () => {\r\n            this.removeListener(eventName, fn);\r\n            this.removeEventListeners = this.removeEventListeners.filter(o => o !== removeFn);\r\n        };\r\n\r\n        removeFn.eventName = eventName;\r\n\r\n        if (!this.removeEventListeners) {\r\n            this.removeEventListeners = [];\r\n        }\r\n\r\n        this.removeEventListeners.push(removeFn);\r\n\r\n        return removeFn;\r\n    }\r\n\r\n    public one(eventName: string, fn: (...args: any[]) => void) {\r\n        const dispose = this.on(eventName, (...args: any[]) => {\r\n            fn(...args);\r\n            dispose();\r\n        });\r\n\r\n        return dispose;\r\n    }\r\n\r\n    public removeByName(name: string) {\r\n        this.removeEventListeners.forEach((fn) => {\r\n            if ((fn as any).eventName === name) fn();\r\n        });\r\n\r\n        this.removeEventListeners = this.removeEventListeners.filter(\r\n            o => (o as any).eventName !== name,\r\n        );\r\n    }\r\n\r\n    public removeAll() {\r\n        this.removeEventListeners.forEach(fn => fn());\r\n        this.removeEventListeners = [];\r\n    }\r\n\r\n    /** @returns Collection */\r\n    public createCollection() {\r\n        return new Collection();\r\n    }\r\n\r\n    public listenToMany(...listeners: (() => void)[]) {\r\n        const collection = this.createCollection();\r\n        collection.getCollection().push(...listeners);\r\n        return () => collection.removeAll();\r\n    }\r\n}\r\n\r\nexport default EventEmitter;\r\n","import React, {useCallback, useState} from 'react';\r\nimport {getLang} from \"@web3game/lang\";\r\nimport {Button, Input, List, ListItem, ListTitle, Page, Icon, Modal, Toast} from \"react-onsenui\";\r\nimport {withAPI} from \"@web3game/common/components/withAPI\";\r\nimport {compose} from \"@web3game/common/utils/compose\";\r\nimport {hot} from \"react-hot-loader\";\r\nimport Clipboard from 'react-clipboard.js';\r\nimport {InvitationInfo} from \"@web3game/typings/home\";\r\nimport {getHomeAPI} from \"@web3game/apis/home/getHomeAPI\";\r\nimport {watchAccountChange} from \"@web3game/common/utils/watchAccountChange\";\r\nimport {createHeaderRender} from \"../Header\";\r\nimport {Block} from \"../common/Block\";\r\n\r\n// https://www.npmjs.com/package/qrcode\r\n\r\nexport type InvitationPageProps = InvitationInfo & {\r\n    onSetInvitor: (invitor: string) => void;\r\n};\r\n\r\nexport function InvitationPagePure(\r\n    {\r\n        code,\r\n        myInviter,\r\n        invitationList,\r\n        onSetInvitor,\r\n    }: InvitationPageProps,\r\n) {\r\n    const renderFixed = createHeaderRender(getLang().HOME_PAGE.INVITATION);\r\n    const [invitatorValue, setInvitatorValue] = useState('');\r\n    const [toastText, setToastText] = useState('');\r\n    const submitInvitator = () => {\r\n        onSetInvitor(invitatorValue);\r\n    };\r\n    const showToast = (text: string) => {\r\n        setToastText(text);\r\n        setTimeout(() => setToastText(''), 1000);\r\n    };\r\n    const renderInvitorForm = () => {\r\n        return (\r\n            <Block noMargin>\r\n                <div className=\"inputGroup\">\r\n                    <Input onChange={e => setInvitatorValue(e.target.value)} />\r\n                    <Button style={{ width: 190 }} onClick={submitInvitator}>\r\n                        {getLang().HOME_PAGE.SET_INVITOR}\r\n                    </Button>\r\n                </div>\r\n            </Block>\r\n        );\r\n    };\r\n\r\n    const renderCode = () => {\r\n        return (\r\n            <Clipboard\r\n                component=\"a\"\r\n                data-clipboard-text={code}\r\n            >\r\n                <span onClick={() => showToast(`${getLang().COPIED} ${code}`)}>\r\n                    {code}\r\n                    {\"  \"}\r\n                    <Icon\r\n                        icon=\"md-copy\"\r\n                    />\r\n                </span>\r\n            </Clipboard>\r\n        );\r\n    }\r\n\r\n\r\n    return (\r\n        <Page renderFixed={renderFixed}>\r\n            <Block noMargin oneHorizontalPadding transparent>\r\n                <Block>\r\n                    {getLang().HOME_PAGE.MY_INVITATION_CODE}\r\n                    {\"  \"}\r\n                    {code && code !== '' && renderCode()}\r\n                    <Toast isOpen={!!toastText}>\r\n                        <span>{toastText}</span>\r\n                    </Toast>\r\n                </Block>\r\n\r\n                <Block noMargin oneMarginBottom>\r\n                    {getLang().HOME_PAGE.MY_INVITOR}\r\n                    {\"   \"}\r\n                    <span style={{fontSize: '12px'}}>{myInviter && myInviter !== '0x0000000000000000000000000000000000000000' ? myInviter : ''}</span>\r\n                    {(!myInviter || myInviter === '0x0000000000000000000000000000000000000000') && renderInvitorForm()}\r\n                </Block>\r\n\r\n                <Block noMargin>\r\n                    <div className=\"textGrey\">\r\n                        <ListTitle style={{ fontSize: 16 }}>\r\n                            {getLang().HOME_PAGE.MY_GROUP}\r\n                        </ListTitle>\r\n                        <List\r\n                            style={{fontSize: \"12px\"}}\r\n                            dataSource={invitationList}\r\n                            renderRow={(item: any, index: number) => (\r\n                                <ListItem key={index}>\r\n                                    <span>{index + 1}.</span>\r\n                                    <span style={{paddingLeft: \"3px\"}}>{item}</span>\r\n                                </ListItem>\r\n                            )}\r\n                        />\r\n                    </div>\r\n                </Block>\r\n            </Block>\r\n\r\n        </Page>\r\n    );\r\n}\r\n\r\nexport const InvitationPage = compose<InvitationPageProps>(\r\n    hot(module),\r\n    React.memo,\r\n    watchAccountChange,\r\n    withAPI(async ({ updateDataVersion }) => {\r\n        const homeAPI = await getHomeAPI();\r\n        const {\r\n            invitationList,\r\n            myInviter,\r\n            code,\r\n        } = await homeAPI.getInvitationResponse();\r\n\r\n        const onSetInvitor = (invitor: string) => {\r\n            // 邀请码不允许为空\r\n            if (!invitor || invitor.trim() === '') {\r\n                alert(getLang().INVITE.INVITATION_CODE_EMPTY);\r\n                return;\r\n            }\r\n            // 邀请码不合法\r\n            if (invitor.length > 6) {\r\n                alert(getLang().INVITE.INVITATION_CODE_INVALID);\r\n                return;\r\n            }\r\n            (async () => {\r\n                try {\r\n                    await homeAPI.setInvitor(invitor);\r\n                    updateDataVersion();\r\n                } catch (e) {\r\n                    alert(e.message);\r\n                }\r\n            })();\r\n        };\r\n\r\n        return {\r\n            invitationList,\r\n            myInviter,\r\n            code,\r\n            onSetInvitor,\r\n        };\r\n    }),\r\n)(InvitationPagePure);\r\n\r\nexport default InvitationPage;\r\n","import React from 'react';\r\nimport {inject, observer} from \"mobx-react\";\r\nimport {AccountStore} from \"../stores/AccountStore\";\r\nimport {compose} from \"./compose\";\r\n\r\ntype RC<P> = React.ComponentType<P> | React.FunctionComponent<P> ;\r\n\r\n\r\ntype WatchLocaleInjectedProps = { accountStore: AccountStore };\r\n\r\nexport function injectMainAccountData<P>(Component: RC<P>) {\r\n    return inject(\r\n        (\r\n            {\r\n                accountStore,\r\n            }: WatchLocaleInjectedProps,\r\n        ) => (\r\n            {\r\n                locale: accountStore.locale,\r\n                dataVersion: accountStore.dataVersion,\r\n                updateDataVersion: () => accountStore.updateDataVersion(),\r\n            }\r\n        ),\r\n    )(Component);\r\n}\r\n\r\nexport function watchAccountChange<P>(Component: RC<P>) {\r\n    return compose<P>(\r\n        observer,\r\n        injectMainAccountData,\r\n    )(Component);\r\n}\r\n\r\n\r\n","import React, {\r\n    ComponentType,\r\n    FunctionComponent,\r\n    MemoExoticComponent,\r\n    NamedExoticComponent,\r\n    useEffect,\r\n    useState,\r\n} from \"react\";\r\nimport _, {values} from 'lodash';\r\n\r\nconst defaultGetAPIDependencies = (props: any) => values(props);\r\ntype APIDependenciesGetter<P> = (props: P) => any[];\r\ntype APIFetcher<P> = (props: P) => Promise<object>\r\n\r\n/* eslint @typescript-eslint/indent:0 */\r\ntype WithAPIComponentType<P> = FunctionComponent<P>\r\n    |ComponentType<P>\r\n    | MemoExoticComponent<ComponentType<P>>\r\n    | NamedExoticComponent<P>;\r\n\r\nexport function withAPI<P extends object>(\r\n    apiFetchers: APIFetcher<Partial<P>>,\r\n    getApiDependencies: APIDependenciesGetter<P> = defaultGetAPIDependencies,\r\n) {\r\n    return (Component: WithAPIComponentType<P>) => React.memo<P>(\r\n        (props: P) => {\r\n            const [apiValues, setApiValues] = useState({});\r\n            const dependencies = getApiDependencies(props);\r\n            const dataVersion = _.get(props, 'dataVersion');\r\n            if (dataVersion) {\r\n                dependencies.push(dataVersion);\r\n            }\r\n\r\n            useEffect(\r\n                () => {\r\n                    (async () => {\r\n                        const responseValues = await apiFetchers(props);\r\n                        setApiValues(responseValues);\r\n                    })();\r\n                },\r\n                dependencies,\r\n            );\r\n\r\n            const C = Component as any;\r\n\r\n            return (\r\n                <C\r\n                    {...props}\r\n                    {...apiValues}\r\n                />\r\n            );\r\n        },\r\n    );\r\n}\r\n","import React from 'react';\r\nimport {BackButton, Toolbar} from \"react-onsenui\";\r\nimport {getLang} from \"@web3game/lang\";\r\nimport {popPage} from \"@web3game/common/utils/navigatorHelper\";\r\n\r\ntype HeaderProps = {\r\n    title?: string;\r\n    hasBack?: boolean;\r\n    backText?: string;\r\n    onBack?: () => void;\r\n    renderRightButton?: () => (React.ReactElement | null);\r\n};\r\n\r\nexport function Header(\r\n    {\r\n        backText = getLang().BACK,\r\n        hasBack = true,\r\n        onBack = () => popPage(),\r\n        title = '',\r\n        renderRightButton = () => null,\r\n    }: HeaderProps,\r\n) {\r\n    return (\r\n        <Toolbar>\r\n            <div className=\"left\">\r\n                {!hasBack ? null : (\r\n                    <BackButton onClick={onBack}>\r\n                        {backText}\r\n                    </BackButton>\r\n                )}\r\n            </div>\r\n            <div className=\"center\">\r\n                {title}\r\n            </div>\r\n            <div className=\"right\">\r\n                {renderRightButton()}\r\n            </div>\r\n        </Toolbar>\r\n    );\r\n}\r\n\r\nexport const createHeaderRender = (\r\n    title: string,\r\n    otherProps: HeaderProps = {},\r\n) => () => (\r\n    <Header title={title} {...otherProps} />\r\n);\r\n\r\nexport const createNoBackHeaderRender = (\r\n    title: string,\r\n) => createHeaderRender(title, { hasBack: false });\r\n","import {HomeAPI} from './HomeAPI';\r\nimport {isUsingMockAPI} from \"../isUsingMockAPI\";\r\n\r\n\r\nexport async function getHomeAPI(): Promise<HomeAPI> {\r\n\r\n    if (isUsingMockAPI()) {\r\n        return import('./HomeAPIMock').then(m => m.default);\r\n    }\r\n\r\n    return import('./HomeAPIReal').then(m => m.default);\r\n}\r\n"],"sourceRoot":""}